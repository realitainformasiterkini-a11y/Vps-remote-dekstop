<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tutorial Docker XFCE + Chrome Remote Desktop</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f8f9fa; color: #222; margin: 0; padding: 0; }
    .container { max-width: 900px; margin: 40px auto; background: #fff; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); padding: 32px; }
    h1, h2, h3 { color: #0056b3; }
    pre, code { background: #f0f0f0; border-radius: 4px; padding: 8px; font-size: 15px; }
    ul, ol { margin-left: 24px; }
    .section { margin-bottom: 32px; }
    .tips { background: #e7f7e7; border-left: 4px solid #4caf50; padding: 12px; margin: 16px 0; }
    .error { background: #fff3f3; border-left: 4px solid #e53935; padding: 12px; margin: 16px 0; }
    .summary { background: #e3f2fd; border-left: 4px solid #2196f3; padding: 12px; margin: 16px 0; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Tutorial Lengkap Docker XFCE + Chrome Remote Desktop (CRD)</h1>
    <div class="section">
      <h2>1. Konsep &amp; Tujuan</h2>
      <ul>
        <li>Menyimpan semua pengaturan, aplikasi, dan file XFCE secara <b>persistent</b> di folder <code>data</code>.</li>
        <li>Menggunakan Docker agar environment bisa di-clone dan dijalankan di akun lain.</li>
        <li>Mengakses desktop Linux secara remote via Chrome Remote Desktop.</li>
      </ul>
    </div>
    <div class="section">
      <h2>2. Struktur Project</h2>
      <ul>
        <li><b>Dockerfile</b>: Image XFCE + CRD + user custom</li>
        <li><b>app.bin</b>: Script setup CRD</li>
        <li><b>data/</b>: Folder persistent home user XFCE</li>
        <li><b>tutor-docker.txt</b>: Tutorial singkat</li>
        <li><b>tutor-docker2.txt</b>: Tutorial lengkap & troubleshooting</li>
      </ul>
    </div>
    <div class="section">
      <h2>3. Setup Awal</h2>
      <ol>
        <li><b>Build Docker Image</b><br>
          <pre>docker build -t xfce-crd-custom .</pre>
        </li>
        <li><b>Perbaiki Permission Folder Data</b><br>
          <pre>sudo chown -R 1001:1001 data
sudo chmod -R 700 data</pre>
        </li>
      </ol>
    </div>
    <div class="section">
      <h2>4. Menjalankan Container</h2>
      <ol>
        <li><b>Jalankan Container</b><br>
          <pre>docker run -it --privileged -v $(pwd)/data:/home/sukrimardana -v $(pwd)/app.bin:/app.bin xfce-crd-custom /bin/bash</pre>
        </li>
        <li><b>Jalankan Setup app.bin</b><br>
          <pre>chmod +x /app.bin
/app.bin</pre>
          <ul>
            <li>Masukkan kode otorisasi CRD dari <a href="https://remotedesktop.google.com" target="_blank">remotedesktop.google.com</a></li>
            <li>Masukkan username, password, dan PIN</li>
          </ul>
        </li>
      </ol>
    </div>
    <div class="section">
      <h2>5. Commit &amp; Push Perubahan</h2>
      <ol>
        <li><b>Keluar dari Container</b><br>
          <pre>exit</pre>
        </li>
        <li><b>Commit &amp; Push Data</b><br>
          <pre>git add data
git commit -m "Update pengaturan XFCE dan aplikasi"
git push</pre>
        </li>
      </ol>
    </div>
    <div class="section">
      <h2>6. Clone &amp; Jalankan di Akun Lain</h2>
      <ol>
        <li><b>Clone Repository</b><br>
          <pre>git clone &lt;repo-url&gt;
cd Vps-remote-dekstop</pre>
        </li>
        <li><b>Jalankan Docker</b><br>
          <pre>docker run -it --privileged -v $(pwd)/data:/home/sukrimardana -v $(pwd)/app.bin:/app.bin xfce-crd-custom /bin/bash</pre>
        </li>
        <li><b>Setup app.bin jika perlu</b><br>
          <pre>chmod +x /app.bin
/app.bin</pre>
        </li>
      </ol>
    </div>
    <div class="section">
      <h2>7. Troubleshooting &amp; Error</h2>
      <div class="error">
        <b>a. Permission Error (data tidak bisa diakses)</b><br>
        <pre>sudo chown -R 1001:1001 data
sudo chmod -R 700 data</pre>
      </div>
      <div class="error">
        <b>b. Push Ditolak (ada file rahasia)</b><br>
        <pre>rm data/.config/chrome-remote-desktop/host#*.json
git add data
git commit -m "Hapus file rahasia CRD"
git push</pre>
        <p>Jika tetap gagal, gunakan git-filter-repo di clone mirror:</p>
        <pre>git clone --mirror &lt;repo-url&gt; repo-clean
cd repo-clean
git filter-repo --path data/.config/chrome-remote-desktop/host#*.json --invert-paths --force
git remote add origin &lt;repo-url&gt;
git push --force --mirror</pre>
      </div>
      <div class="error">
        <b>c. OAuth Error saat setup CRD</b><br>
        <ul>
          <li>Pastikan kode otorisasi CRD baru dari Google.</li>
          <li>Hapus file konfigurasi lama: <code>rm -rf data/.config/chrome-remote-desktop/host#*.json</code></li>
          <li>Jalankan ulang app.bin.</li>
        </ul>
      </div>
      <div class="error">
        <b>d. Container Exit/Tidak Berjalan</b><br>
        <ul>
          <li>Jalankan ulang perintah docker run di atas.</li>
          <li>Pastikan tidak exit dari shell container.</li>
        </ul>
      </div>
      <div class="error">
        <b>e. Tidak Bisa Akses Remote Desktop</b><br>
        <ul>
          <li>Pastikan container dan proses CRD aktif: <code>docker ps</code>, <code>ps aux | grep chrome-remote-desktop</code></li>
          <li>Pastikan port 3389 terbuka: <code>netstat -tulnp | grep 3389</code></li>
          <li>Gunakan akun Google yang sama saat setup dan akses.</li>
        </ul>
      </div>
    </div>
    <div class="section tips">
      <h2>8. Tips &amp; Best Practice</h2>
      <ul>
        <li>Jangan commit file rahasia ke repository publik.</li>
        <li>Selalu gunakan volume Docker agar data persistent.</li>
        <li>Untuk update, ulangi proses commit dan push dari host.</li>
        <li>Untuk clone di akun lain, cukup clone repo dan jalankan docker dengan volume data.</li>
      </ul>
    </div>
    <div class="section summary">
      <h2>9. Ringkasan Alur</h2>
      <ol>
        <li>Build image → Perbaiki permission → Jalankan container → Setup CRD → Commit &amp; push data → Clone di akun lain → Jalankan ulang container → Semua pengaturan XFCE tetap ada.</li>
      </ol>
      <p>Tutorial ini merangkum semua pembahasan, error, dan solusi dari awal hingga akhir agar setup Docker XFCE + CRD Anda selalu aman dan bisa diakses di mana saja.</p>
    </div>
  </div>
</body>
</html>
